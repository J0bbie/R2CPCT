% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysisWGS_rundNdS.R
\name{rundNdS}
\alias{rundNdS}
\title{Perform dN/dS analysis on a set of mutations from multiple CPCT-02 samples.}
\usage{
rundNdS(dataMuts)
}
\arguments{
\item{dataMuts}{(VRanges): VRanges containing the mutations which will be inputted into dN/dS.}
}
\value{
(tibble) Returns a tibble of the dNdS results.
}
\description{
Perform dN/dS analysis on a set of mutations from multiple CPCT-02 samples.
}
\details{
The dNdS database was made from ENSEMBL v101 (GENCODE v35) using the following code and following the dN/dS buildref vignette:

 # Remove non-standard chromosomes, clone-based genes and CDS which cannot be divided by 3.
 ENSEMBLv101 <- readr::read_tsv('~/test/dNdS/Oct2020/mart_export.txt') %>%
  dplyr::filter(!grepl('_', `Chromosome/scaffold name`)) %>%
  dplyr::filter(`CDS Length` %% 3 == 0) %>%
  dplyr::filter(!is.na(`Genomic coding start`)) %>%
  dplyr::filter(!grepl('^AC[0-9]', `Gene name`)) %>%
  dplyr::filter(!grepl('^AP00|^RP11-', `Gene name`)) %>%
  dplyr::filter(!grepl('\\.', `Gene name`)) %>%
  dplyr::select(
      'gene.id' = `Gene stable ID`,
       'gene.name' = `Gene name`,
       'cds.id' = `Protein stable ID`,
       'chr' = `Chromosome/scaffold name`,
       'chr.coding.start' = `Genomic coding start`,
       'chr.coding.end' = `Genomic coding end`,
       'cds.start' = `CDS start`,
       'cds.end' = `CDS end`,
       'length' = `CDS Length`,
       'strand' = Strand)

write.table(ENSEMBLv101, file = '~/test/dNdS/Oct2020/mart_export_filtered.txt', row.names = F, quote = F)

# Generate refCDS database.
pathCDS = '~/test/dNdS/Oct2020/mart_export_filtered.txt'
pathFasta = '/mnt/data/ccbc_environment/general/genomes/hsapiens/hg19_HMF/Homo_sapiens.GRCh37.GATK.illumina.fasta'
dndscv::buildref(cdsfile = pathCDS, genomefile = pathFasta, outfile = 'inst/extdata/refCDS_ENSEMBLv101_HMF.rda', excludechrs='MT', useids = T)
}
\examples{
\dontrun{

 data.Cohort <- R2CPCT::importWGSOfCohort(<cpctIds>, <combinedData>)
 rundNdS(data.Cohort$somaticVariants)

}
}
